<app-header></app-header>

<main class="history-page">
  <div class="container">
    <header class="page-header">
      <h1>Hist칩rico de Relat칩rios</h1>
      <p>Visualize e baixe os resultados das suas consultas anteriores.</p>
    </header>

    @if (isLoading) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Buscando seus relat칩rios...</p>
      </div>
    } @else {
      <div class="reports-list">
        @for (report of reports; track report.id) {
          <div class="report-card" [ngClass]="{'processing': report.status === 'PROCESSING', 'error-card': report.status === 'ERROR'}">
            <div class="card-main">
              <div class="info-group">
                <span class="label">Data de Gera칞칚o</span>
                <span class="value">{{ report.createAt | date:'dd/MM/yyyy HH:mm' }}</span>
              </div>
              
              <div class="info-group">
                <span class="label">Identificador (ID)</span>
                <span class="value id-text">{{ report.id }}</span>
              </div>

              <div class="status-group">
                <span class="status-badge" [ngClass]="report.status.toLowerCase()">
                  {{ 
                    report.status === 'COMPLETED' ? 'Conclu칤do' : 
                    report.status === 'PROCESSING' ? 'Em Processamento' : 'Erro' 
                  }}
                </span>
              </div>
            </div>

            <div class="card-actions">
              <button class="btn-view" 
                      (click)="openReport(report.urlFile)"
                      [disabled]="report.status !== 'COMPLETED'">
                <span class="icon">游늯</span> 
                {{ 
                  report.status === 'COMPLETED' ? 'Ver Relat칩rio' : 
                  report.status === 'PROCESSING' ? 'Processando...' : 'Indispon칤vel' 
                }}
              </button>
            </div>
          </div>
        } @empty {
          <div class="empty-state">
            <span class="icon">游늭</span>
            <h3>Nenhum relat칩rio encontrado</h3>
            <p>Voc칡 ainda n칚o realizou nenhuma consulta ou seus arquivos est칚o sendo processados.</p>
          </div>
        }
      </div>
    }
  </div>
</main>

<app-footer></app-footer>
