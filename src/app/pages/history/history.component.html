<app-header></app-header>

<main class="history-page">
  <div class="container">
    <header class="page-header">
      <h1>Hist贸rico de Relat贸rios</h1>
      <p>Visualize e baixe os resultados das suas consultas anteriores.</p>
    </header>

    @if (isLoading) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Buscando seus relat贸rios...</p>
      </div>
    } @else {
      <div class="reports-list">
        @for (report of reports; track report.id) {
          <div class="report-card" [ngClass]="{'processing': report.status === 'processing'}">
            <div class="card-main">
              <div class="info-group">
                <span class="label">Data de Gera莽茫o</span>
                <span class="value">{{ report.generatedAt | date:'dd/MM/yyyy HH:mm' }}</span>
              </div>
              
              <div class="info-group">
                <span class="label">Identificador (ID)</span>
                <span class="value id-text">{{ report.id }}</span>
              </div>

              <div class="status-group">
                <span class="status-badge" [ngClass]="report.status">
                  {{ report.status === 'completed' ? 'Conclu铆do' : 'Em Processamento' }}
                </span>
              </div>
            </div>

            <div class="card-actions">
              <button class="btn-view" 
                      (click)="openReport(report.reportUrl)"
                      [disabled]="report.status !== 'completed'">
                <span class="icon"></span> 
                {{ report.status === 'completed' ? 'Ver Relat贸rio' : 'Processando...' }}
              </button>
            </div>
          </div>
        } @empty {
          <div class="empty-state">
            <span class="icon"></span>
            <h3>Nenhum relat贸rio encontrado</h3>
            <p>Voc锚 ainda n茫o realizou nenhuma consulta ou seus arquivos est茫o sendo processados.</p>
          </div>
        }
      </div>
    }
  </div>
</main>

<app-footer></app-footer>
